//// Docs: https://dbml.dbdiagram.io/docs
//// -- ER Diagram for Drug/Medicine Ecommerce Web App
//// -- Tables: users, roles, diagnoses, drugs, carts, orders, payments

// Table for roles
Table roles {
  id uuid [pk]
  name varchar(255) [unique]
  description text
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

// Table for users
Table users {
  id uuid [pk]
  username varchar(255) [unique]
  email varchar(255) [unique]
  password varchar(255)
  role_id uuid [ref: > roles.id]
  full_name varchar(255)
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

// Table for diagnoses
Table diagnoses {
  id uuid [pk]
  user_id uuid [ref: > users.id]
  symptoms text
  diagnosis text
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

Table recommended_drugs {
  id uuid [pk]
  diagnoses_id uuid [ref: > diagnoses.id]
  drug_id uuid [ref: > drugs.id]
  quantity int
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

// Table for drugs
Table drugs {
  id uuid [pk]
  generic_name varchar(255)
  description text
  picture text
  price decimal(10,2)
  manufacturer_id uuid [ref: > manufacturers.id]
  dosage_form_id uuid [ref: > dosage_forms.id]
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

// Table for dosage forms
Table dosage_forms {
  id uuid [pk]
  name varchar(255) [unique]
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

// Table for manufacturers
Table manufacturers {
  id uuid [pk]
  name varchar(255) [unique]
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

// Table for active ingredients
Table active_ingredients {
  id uuid [pk]
  name varchar(255) [unique]
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

// Table for brands
Table brands {
  id uuid [pk]
  name varchar(255)
  picture text
  drug_id uuid [ref: > drugs.id]
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}

// Table for drug active ingredients
Table drug_active_ingredients {
  id uuid [pk]
  drug_id uuid [ref: > drugs.id]
  active_ingredient_id uuid [ref: > active_ingredients.id]
  quantity int
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
}