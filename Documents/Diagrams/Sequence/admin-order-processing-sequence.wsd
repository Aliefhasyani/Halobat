@startuml admin-order-processing-sequence
title Admin Order Processing Sequence Diagram

actor Admin
participant "Order\nInterface" as OrderUI
participant "Order\nController" as OrderController
participant "Order\nModel" as OrderModel
participant "Database" as DB

== Admin Views All Orders ==
Admin -> OrderUI: Access admin order management
OrderUI -> OrderController: getAllOrders(filters, pagination)

OrderController -> OrderModel: getAllOrdersWithUsers(filters, limit, offset)
OrderModel -> DB: SELECT o.*, u.username, u.email FROM orders o JOIN users u ON o.user_id = u.id WHERE conditions ORDER BY o.created_at DESC LIMIT ? OFFSET ?
DB --> OrderModel: Orders with user info
OrderModel --> OrderController: Orders data

OrderController --> OrderUI: Orders information
OrderUI --> Admin: Display orders list

== Admin Processes Order ==
Admin -> OrderUI: Select order to process
OrderUI -> OrderController: processOrder(orderId)

OrderController -> OrderModel: getOrder(orderId)
OrderModel -> DB: SELECT * FROM orders WHERE id=?
DB --> OrderModel: Order details
OrderModel --> OrderController: Order data

alt Order status is 'confirmed'
    Admin -> OrderUI: Update order status
    OrderUI -> OrderController: updateOrderStatus(orderId, newStatus)
    
    OrderController -> OrderModel: updateOrderStatus(orderId, newStatus)
    OrderModel -> DB: UPDATE orders SET status=? WHERE id=?
    DB --> OrderModel: Status updated
    OrderModel --> OrderController: Order updated
    
    OrderController --> OrderUI: Status updated successfully
    OrderUI --> Admin: Show success message
    
else Order status not processable
    OrderController --> OrderUI: Cannot process order
    OrderUI --> Admin: Show error message
end

@enduml
